{"version":3,"file":"formbuilder-conditional-logic.es.js","sources":["../src/plugin/builder.ts","../src/renderer/setup.ts"],"sourcesContent":["/**\n * Builder-side plugin helpers for formBuilder.\n * Adds:\n *  - typeUserAttrs for logic JSON, applyTo, logicGroup\n *  - onOpenFieldEdit panel that groups these controls\n *  - Visual Rules Editor (optional) that populates the logic JSON without typing\n */\n\ntype UserAttrs = Record<string, any>;\n\nexport interface FieldMeta {\n    name: string;\n    type: string;\n    label?: string;\n    values?: Array<{ label: string; value: string }>;\n}\n\nexport interface BuilderInitOptions {\n    panelTitle?: string;\n    types?: string[];\n    // Hooks to supply fields/values (generic); if omitted, we try to infer from builder JSON.\n    getAvailableFields?: () => FieldMeta[];\n    getFieldValues?: (fieldName: string) => Array<{ label: string; value: string }> | null;\n    enableVisualEditor?: boolean; // default true\n}\n\nconst DEFAULT_TYPES = [\n    'text', 'textarea', 'number', 'select',\n    'radio-group', 'checkbox-group',\n    'date', 'paragraph', 'header', 'file', 'autocomplete'\n];\n\nexport function withConditionalLogic(opts: BuilderInitOptions = {}) {\n    const panelTitle = opts.panelTitle || 'Conditional Logic';\n    const types = (opts.types && opts.types.length ? opts.types : DEFAULT_TYPES);\n    const enableVE = opts.enableVisualEditor !== false;\n\n    const typeUserAttrs: Record<string, UserAttrs> = {};\n    types.forEach(t => {\n        typeUserAttrs[t] = {\n            logic: {\n                label: `${panelTitle} (JSON)`,\n                type: 'textarea',\n                value: '',\n                placeholder: '{ \"groups\":[...], \"actions\":[\"show\"] }'\n            },\n            logicApplyTo: {\n                label: `${panelTitle}: Apply To`,\n                type: 'select',\n                value: 'self',\n                options: {\n                    self: 'This Field',\n                    container: 'Field Container',\n                    group: 'Logic Group (below)'\n                }\n            },\n            logicGroup: {\n                label: `${panelTitle}: Group ID`,\n                type: 'text',\n                value: '',\n                placeholder: 'e.g., vehicleDetails'\n            }\n        };\n    });\n\n    function inferFieldsFromBuilderJson(): FieldMeta[] {\n        try {\n            // formBuilder exposes the active instance via jQuery selection; we can sniff current JSON if needed.\n            const stage = (window as any).jQuery?.('.build-wrap');\n            const inst = stage?.data('formBuilder');\n            const json = inst?.actions?.getData?.('json');\n            const arr = typeof json === 'string' ? JSON.parse(json) : Array.isArray(json) ? json : [];\n            return arr.filter((f: any) => f?.name).map((f: any) => ({\n                name: f.name,\n                type: f.type,\n                label: f.label,\n                values: Array.isArray(f.values) ? f.values.map((v: any) => ({ label: v.label ?? v.value, value: v.value })) : undefined\n            }));\n        } catch { return []; }\n    }\n\n    function getFields(): FieldMeta[] {\n        try {\n            const custom = opts.getAvailableFields?.();\n            if (custom && custom.length) return custom;\n        } catch { }\n        return inferFieldsFromBuilderJson();\n    }\n\n    function getValuesFor(fieldName: string): Array<{ label: string; value: string }> | null {\n        try {\n            const custom = opts.getFieldValues?.(fieldName);\n            if (custom) return custom;\n        } catch { }\n        const fm = getFields().find(f => f.name === fieldName);\n        return fm?.values ?? null;\n    }\n\n    function makeVE(\n        htmlParent: HTMLElement,\n        getTextArea: () => HTMLTextAreaElement,\n        getApplyTo: () => HTMLSelectElement,\n        getGroupId: () => HTMLInputElement\n    ) {\n        // outer wrapper\n        const ve = document.createElement('div');\n        ve.className = 'fb-logic-ve';\n        ve.style.marginBottom = '8px';\n\n        // header (outside the dashed border)\n        const hdr = document.createElement('div');\n        hdr.className = 'fb-logic-ve-header';\n        hdr.style.marginTop = '0px';\n        hdr.style.fontWeight = '600';\n        hdr.innerHTML = `Visual Rules Editor <span style=\"font-size:12px;opacity:.7;font-weight:400;\">(no JSON typing)</span>`;\n        ve.appendChild(hdr);\n\n        // bordered body\n        const veBody = document.createElement('div');\n        veBody.className = 'fb-logic-ve-body';\n        veBody.style.border = '1px dashed #cbd5e1';\n        veBody.style.padding = '8px';\n        veBody.style.marginTop = '6px';\n        ve.appendChild(veBody);\n\n        // ---- contents go inside veBody ----\n\n        // mode\n        const modeWrap = document.createElement('div');\n        modeWrap.style.margin = '6px 0';\n        modeWrap.innerHTML = `\n    <label style=\"margin-right:8px;\">Mode</label>\n    <select class=\"ve-mode form-select form-select-sm\" style=\"display:inline-block; width:auto;\">\n      <option value=\"any\">ANY (OR)</option>\n      <option value=\"all\">ALL (AND)</option>\n    </select>\n  `;\n        veBody.appendChild(modeWrap);\n\n        // actions\n        const actionsWrap = document.createElement('div');\n        actionsWrap.style.margin = '6px 0';\n        actionsWrap.innerHTML = `\n    <label style=\"margin-right:8px;\">Actions</label>\n    <label class=\"form-check form-check-inline\"><input class=\"form-check-input ve-act\" type=\"checkbox\" value=\"show\" checked> <span class=\"form-check-label\">show</span></label>\n    <label class=\"form-check form-check-inline\"><input class=\"form-check-input ve-act\" type=\"checkbox\" value=\"require\"> <span class=\"form-check-label\">require</span></label>\n    <label class=\"form-check form-check-inline\"><input class=\"form-check-input ve-act\" type=\"checkbox\" value=\"enable\"> <span class=\"form-check-label\">enable</span></label>\n    <label class=\"form-check form-check-inline\"><input class=\"form-check-input ve-act\" type=\"checkbox\" value=\"disable\"> <span class=\"form-check-label\">disable</span></label>\n    <label class=\"form-check form-check-inline\"><input class=\"form-check-input ve-act\" type=\"checkbox\" value=\"hide\"> <span class=\"form-check-label\">hide</span></label>\n  `;\n        veBody.appendChild(actionsWrap);\n\n        // rules container\n        const rules = document.createElement('div');\n        rules.className = 've-rules';\n        veBody.appendChild(rules);\n\n        const addBtn = document.createElement('button');\n        addBtn.type = 'button';\n        addBtn.className = 'btn btn-sm btn-outline-primary';\n        addBtn.textContent = 'Add rule';\n        addBtn.style.marginTop = '8px';\n        veBody.appendChild(addBtn);\n\n        function row(field?: string, op?: string, value?: string) {\n            const row = document.createElement('div');\n            row.className = 've-row';\n            row.style.display = 'grid';\n            row.style.gridTemplateColumns = '1fr 1fr 1fr auto';\n            row.style.gap = '6px';\n            row.style.marginTop = '6px';\n\n            // field select\n            const fSel = document.createElement('select');\n            fSel.className = 'form-select form-select-sm ve-field';\n            getFields().forEach(f => {\n                const opt = document.createElement('option');\n                opt.value = f.name;\n                opt.textContent = f.label ? `${f.label} (${f.name})` : f.name;\n                fSel.appendChild(opt);\n            });\n            if (field) fSel.value = field;\n\n            // operator select\n            const oSel = document.createElement('select');\n            oSel.className = 'form-select form-select-sm ve-op';\n\n            function setOpsForField(fn: string) {\n                const fm = getFields().find(f => f.name === fn);\n                const isNum = fm?.type === 'number';\n                const isChoice = fm?.type === 'radio-group' || fm?.type === 'select' || !!fm?.values?.length;\n                const ops = isNum\n                    ? ['equals', 'notEquals', 'gt', 'gte', 'lt', 'lte', 'isEmpty', 'notEmpty']\n                    : isChoice\n                        ? ['equals', 'notEquals', 'isEmpty', 'notEmpty']\n                        : ['equals', 'notEquals', 'contains', 'startsWith', 'endsWith', 'isEmpty', 'notEmpty'];\n                oSel.innerHTML = '';\n                ops.forEach(o => {\n                    const opt = document.createElement('option');\n                    opt.value = o;\n                    opt.textContent = o;\n                    oSel.appendChild(opt);\n                });\n            }\n\n            setOpsForField(fSel.value);\n            if (op) oSel.value = op;\n\n            // value control (select or input)\n            const vWrap = document.createElement('div');\n            vWrap.className = 've-value-wrap';\n\n            function renderValueControl(fn: string, current?: string) {\n                vWrap.innerHTML = '';\n                const choices = getValuesFor(fn);\n                if (choices && choices.length) {\n                    const s = document.createElement('select');\n                    s.className = 'form-select form-select-sm ve-value';\n                    choices.forEach(c => {\n                        const option = document.createElement('option');\n                        option.value = c.value;\n                        option.textContent = c.label ?? c.value;\n                        s.appendChild(option);\n                    });\n                    if (current) s.value = current;\n                    vWrap.appendChild(s);\n                } else {\n                    const i = document.createElement('input');\n                    i.type = 'text';\n                    i.className = 'form-control form-control-sm ve-value';\n                    if (current) i.value = current;\n                    vWrap.appendChild(i);\n                }\n            }\n\n            renderValueControl(fSel.value, value);\n\n            // remove btn\n            const rm = document.createElement('button');\n            rm.type = 'button';\n            rm.className = 'btn btn-sm btn-link text-danger';\n            rm.textContent = 'remove';\n\n            // interactions\n            fSel.addEventListener('change', () => {\n                setOpsForField(fSel.value);\n                renderValueControl(fSel.value);\n            });\n            rm.addEventListener('click', () => row.remove());\n\n            // mount\n            row.appendChild(fSel);\n            row.appendChild(oSel);\n            row.appendChild(vWrap);\n            row.appendChild(rm);\n            rules.appendChild(row);\n        }\n\n        addBtn.addEventListener('click', () => row());\n\n        // Save button\n        const save = document.createElement('button');\n        save.type = 'button';\n        save.className = 'btn btn-sm btn-primary';\n        save.textContent = 'Save to JSON';\n        save.style.marginTop = '8px';\n        save.style.marginLeft = '8px';\n        veBody.appendChild(save);\n\n        save.addEventListener('click', () => {\n            const _mode = (veBody.querySelector('.ve-mode') as HTMLSelectElement).value as 'any' | 'all';\n            const _actions = Array.from(veBody.querySelectorAll('.ve-act') as NodeListOf<HTMLInputElement>)\n                .filter(i => i.checked).map(i => i.value) as Array<'show' | 'hide' | 'enable' | 'disable' | 'require'>;\n            const ruleRows = Array.from(veBody.querySelectorAll('.ve-row'));\n            const rules = ruleRows.map(r => {\n                const f = (r.querySelector('.ve-field') as HTMLSelectElement).value;\n                const o = (r.querySelector('.ve-op') as HTMLSelectElement).value;\n                const valEl = (r.querySelector('.ve-value') as HTMLInputElement | HTMLSelectElement);\n                const v = (valEl as any).value ?? '';\n                return { field: f, op: o as any, value: v };\n            });\n            const cfg = { groups: [{ mode: _mode, rules, actions: _actions }] };\n            (getTextArea()).value = JSON.stringify(cfg, null, 2);\n            alert('Conditional Logic JSON updated.\\nTip: you can switch back to Visual to adjust again.');\n        });\n\n        // Preload from JSON, if present\n        try {\n            const raw = (getTextArea()).value;\n            if (raw && raw.trim()) {\n                const parsed = JSON.parse(raw);\n                const g = Array.isArray(parsed.groups) ? parsed.groups[0] : null;\n                if (g) {\n                    (veBody.querySelector('.ve-mode') as HTMLSelectElement).value = g.mode || 'any';\n                    const acts = new Set((g.actions || []) as string[]);\n                    veBody.querySelectorAll('.ve-act').forEach((i: any) => { i.checked = acts.has(i.value); });\n                    (g.rules || []).forEach((r: any) => row(r.field, r.op, r.value));\n                }\n            }\n        } catch { /* ignore */ }\n\n        // mount entire VE block\n        htmlParent.prepend(ve);\n    }\n\n\n    function onOpenFieldEdit(editPanel: HTMLElement) {\n        const logicControls = Array.from(\n            editPanel.querySelectorAll('[name=\"logic\"], [name=\"logicApplyTo\"], [name=\"logicGroup\"]')\n        ) as HTMLElement[];\n        if (!logicControls.length) return;\n\n        // Ensure the outer Conditional Logic section exists\n        let section = editPanel.querySelector('.fb-logic-section') as HTMLElement | null;\n        if (!section) {\n            section = document.createElement('div');\n            section.className = 'fb-logic-section';\n            section.innerHTML = `\n        <div class=\"fb-logic-header\" style=\"margin-top:8px; font-weight:600; cursor:pointer;\">\n          ${panelTitle}\n          <span style=\"font-weight:400; font-size:12px; opacity:.7\"> (toggle)</span>\n        </div>\n        <div class=\"fb-logic-body\" style=\"border:1px solid #e5e7eb; padding:8px; margin-top:6px; display:none;\"></div>\n      `;\n            editPanel.appendChild(section);\n\n            const header = section.querySelector('.fb-logic-header') as HTMLElement;\n            const body = section.querySelector('.fb-logic-body') as HTMLElement;\n            header.addEventListener('click', () => {\n                const open = body.style.display !== 'none';\n                body.style.display = open ? 'none' : '';\n            });\n        }\n\n        const body = section!.querySelector('.fb-logic-body') as HTMLElement;\n\n        // ---------- Visual Rules Editor (top, only mount once) ----------\n        if (enableVE) {\n            const getTextArea = () => body.querySelector('[name=\"logic\"]') as HTMLTextAreaElement;\n            const getApplyTo = () => body.querySelector('[name=\"logicApplyTo\"]') as HTMLSelectElement;\n            const getGroupId = () => body.querySelector('[name=\"logicGroup\"]') as HTMLInputElement;\n\n            // Guard: only one VE\n            if (!body.querySelector('.fb-logic-ve')) {\n                // Clean any legacy dupes (just in case)\n                const dupes = body.querySelectorAll('.fb-logic-ve');\n                if (dupes.length > 1) dupes.forEach((el, idx) => { if (idx > 0) el.remove(); });\n\n                makeVE(body, getTextArea, getApplyTo, getGroupId);\n            }\n        }\n\n        // ---------- Advanced (JSON) panel (wrapped + collapsed by default) ----------\n        // Build the advanced container if needed\n        let adv = body.querySelector('.fb-logic-advanced') as HTMLElement | null;\n        if (!adv) {\n            adv = document.createElement('div');\n            adv.className = 'fb-logic-advanced';\n            adv.innerHTML = `\n        <div class=\"fb-logic-adv-header\" style=\"margin-top:10px; font-weight:600; cursor:pointer;\">\n          Advanced (JSON)\n          <span style=\"font-weight:400; font-size:12px; opacity:.7\"> (toggle)</span>\n        </div>\n        <div class=\"fb-logic-adv-body\" style=\"\n          border:1px dashed #cbd5e1;\n          padding:8px;\n          margin-top:6px;\n          display:none; /* collapsed by default */\n        \"></div>\n      `;\n            body.appendChild(adv);\n\n            const advHeader = adv.querySelector('.fb-logic-adv-header') as HTMLElement;\n            const advBody = adv.querySelector('.fb-logic-adv-body') as HTMLElement;\n            advHeader.addEventListener('click', () => {\n                const open = advBody.style.display !== 'none';\n                advBody.style.display = open ? 'none' : '';\n            });\n        }\n\n        // Move the original controls into the Advanced box content\n        const advBody = adv!.querySelector('.fb-logic-adv-body') as HTMLElement;\n        logicControls.forEach(el => {\n            const row = el.closest('.form-group') || el.closest('div') || el;\n            if (row && row.parentElement !== advBody) advBody.appendChild(row as HTMLElement);\n        });\n\n        // Guard: if somehow controls were duplicated by upstream UI reflows, keep one\n        const seen = new Set<string>();\n        advBody.querySelectorAll<HTMLElement>('[name=\"logic\"], [name=\"logicApplyTo\"], [name=\"logicGroup\"]').forEach(ctrl => {\n            const n = ctrl.getAttribute('name')!;\n            if (seen.has(n)) {\n                const dupRow = ctrl.closest('.form-group') || ctrl.closest('div') || ctrl;\n                if (dupRow && dupRow.parentElement === advBody) (dupRow as HTMLElement).remove();\n            } else {\n                seen.add(n);\n            }\n        });\n    }\n\n\n    return { typeUserAttrs, onOpenFieldEdit };\n}\n\n/**\n * Form-level groups JSON manager (as before)\n */\nexport function attachLogicGroupsManager(\n    targetContainer: HTMLElement,\n    initialOrOpts?: string | {\n        initialJson?: string;\n        getAvailableFields?: () => FieldMeta[];\n        getFieldValues?: (fieldName: string) => Array<{ label: string; value: string }> | null;\n    }\n) {\n    const opts = (typeof initialOrOpts === 'string')\n        ? { initialJson: initialOrOpts }\n        : (initialOrOpts || {});\n\n    const state = {\n        json: opts.initialJson || '',\n    };\n\n    // Helpers to obtain fields/values (mirror the per-field hooks)\n    function inferFieldsFromBuilderJson(): FieldMeta[] {\n        try {\n            const stage = (window as any).jQuery?.('.build-wrap');\n            const inst = stage?.data?.('formBuilder');\n            const json = inst?.actions?.getData?.('json');\n            const arr = typeof json === 'string' ? JSON.parse(json) : Array.isArray(json) ? json : [];\n            return arr.filter((f: any) => f?.name).map((f: any) => ({\n                name: f.name, type: f.type, label: f.label,\n                values: Array.isArray(f.values) ? f.values.map((v: any) => ({ label: v.label ?? v.value, value: v.value })) : undefined\n            }));\n        } catch { return []; }\n    }\n\n    function getFields(): FieldMeta[] {\n        try { const custom = opts.getAvailableFields?.(); if (custom && custom.length) return custom; } catch { }\n        return inferFieldsFromBuilderJson();\n    }\n\n    function getValuesFor(fieldName: string): Array<{ label: string; value: string }> | null {\n        try { const custom = opts.getFieldValues?.(fieldName); if (custom) return custom; } catch { }\n        const fm = getFields().find(f => f.name === fieldName);\n        return fm?.values ?? null;\n    }\n\n    // ----- UI scaffold (button + modal) -----\n    const wrapper = document.createElement('div');\n    wrapper.style.margin = '8px 0';\n    wrapper.innerHTML = `\n    <button type=\"button\" class=\"btn btn-sm btn-outline-primary\">Logic Groups</button>\n    <div class=\"fb-logic-modal\" style=\"display:none; position:fixed; inset:0; background:rgba(0,0,0,.4); z-index:99999;\">\n      <div style=\"background:#fff; max-width:900px; width:92%; margin:4% auto; padding:16px; border-radius:8px;\">\n        <div style=\"display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:8px;\">\n          <strong style=\"font-size:16px;\">Logic Groups</strong>\n          <div style=\"display:flex; gap:8px;\">\n            <button type=\"button\" class=\"btn btn-sm btn-secondary fb-groups-load-sample\">Load sample</button>\n            <button type=\"button\" class=\"btn btn-sm btn-outline-secondary fb-groups-from-json\">From JSON</button>\n            <button type=\"button\" class=\"btn btn-sm btn-primary fb-groups-save\">Save</button>\n            <button type=\"button\" class=\"btn btn-sm btn-light fb-logic-close\">Close</button>\n          </div>\n        </div>\n\n        <!-- Visual Editor header outside border -->\n        <div class=\"fb-groups-ve-header\" style=\"font-weight:600;\">Visual Groups Editor\n          <span style=\"font-size:12px;opacity:.7;font-weight:400;\">(no JSON typing)</span>\n        </div>\n        <div class=\"fb-groups-ve-body\" style=\"border:1px dashed #cbd5e1; padding:8px; margin-top:6px;\">\n          <div class=\"fb-groups-list\"></div>\n          <button type=\"button\" class=\"btn btn-sm btn-outline-primary fb-groups-add\" style=\"margin-top:8px;\">Add group</button>\n        </div>\n\n        <!-- Advanced (collapsed by default) -->\n        <div class=\"fb-groups-adv\" style=\"margin-top:10px;\">\n          <div class=\"fb-groups-adv-header\" style=\"font-weight:600; cursor:pointer;\">\n            Advanced (JSON)\n            <span style=\"font-size:12px;opacity:.7;font-weight:400;\">(toggle)</span>\n          </div>\n          <div class=\"fb-groups-adv-body\" style=\"border:1px dashed #cbd5e1; padding:8px; margin-top:6px; display:none;\">\n            <p style=\"font-size:12px; margin: 0 0 6px 0; opacity:.75;\">\n              Define reusable groups keyed by ID. Example:\n            </p>\n            <pre style=\"background:#f8fafc; padding:6px; border-radius:6px; font-size:12px; margin-top:0;\">{\n  \"vehicleDetails\": {\n    \"mode\": \"any\",\n    \"rules\": [{ \"field\": \"hasVehicle\", \"op\": \"equals\", \"value\": \"yes\" }],\n    \"actions\": [\"show\", \"require\"]\n  }\n}</pre>\n            <textarea class=\"fb-logic-json\" style=\"width:100%; height:240px; font-family:monospace;\"></textarea>\n          </div>\n        </div>\n      </div>\n    </div>\n  `;\n    targetContainer.prepend(wrapper);\n\n    const btn = wrapper.querySelector('button') as HTMLButtonElement;\n    const modal = wrapper.querySelector('.fb-logic-modal') as HTMLDivElement;\n    const closeBtn = modal.querySelector('.fb-logic-close') as HTMLButtonElement;\n    const loadBtn = modal.querySelector('.fb-groups-load-sample') as HTMLButtonElement;\n    const saveBtn = modal.querySelector('.fb-groups-save') as HTMLButtonElement;\n    const fromJson = modal.querySelector('.fb-groups-from-json') as HTMLButtonElement;\n    const advHdr = modal.querySelector('.fb-groups-adv-header') as HTMLDivElement;\n    const advBody = modal.querySelector('.fb-groups-adv-body') as HTMLDivElement;\n    const ta = modal.querySelector('.fb-logic-json') as HTMLTextAreaElement;\n\n    const listEl = modal.querySelector('.fb-groups-list') as HTMLDivElement;\n    const addBtn = modal.querySelector('.fb-groups-add') as HTMLButtonElement;\n\n    const open = () => {\n        // Initial source: window.fbLogicGroups → state.json → textarea → VE\n        const srcObj = (window as any).fbLogicGroups && typeof (window as any).fbLogicGroups === 'object'\n            ? (window as any).fbLogicGroups\n            : (state.json ? safeParse(state.json) : {});\n        state.json = JSON.stringify(srcObj || {}, null, 2);\n        ta.value = state.json;\n        // Rebuild VE from current JSON\n        renderFromJson(srcObj || {});\n        modal.style.display = 'block';\n    };\n    const close = () => { modal.style.display = 'none'; };\n\n    btn.addEventListener('click', open);\n    closeBtn.addEventListener('click', close);\n    modal.addEventListener('click', (e) => { if (e.target === modal) close(); });\n\n    advHdr.addEventListener('click', () => {\n        const open = advBody.style.display !== 'none';\n        advBody.style.display = open ? 'none' : '';\n    });\n\n    loadBtn.addEventListener('click', () => {\n        const sample = {\n            vehicleDetails: {\n                mode: 'any',\n                rules: [{ field: 'hasVehicle', op: 'equals', value: 'yes' }],\n                actions: ['show', 'require']\n            }\n        };\n        ta.value = JSON.stringify(sample, null, 2);\n        renderFromJson(sample);\n    });\n\n    fromJson.addEventListener('click', () => {\n        const parsed = safeParse(ta.value) || {};\n        renderFromJson(parsed);\n    });\n\n    saveBtn.addEventListener('click', () => {\n        const obj = collectFromVe();\n        state.json = JSON.stringify(obj, null, 2);\n        ta.value = state.json;\n        (window as any).fbLogicGroups = obj;\n        alert('Logic groups saved (visual & JSON). Available as window.fbLogicGroups.');\n        close();\n    });\n\n    addBtn.addEventListener('click', () => addGroupBlock());\n\n    // ---- VE rendering helpers ----\n    function safeParse(txt: string): any | null {\n        try { return JSON.parse(txt); } catch { return null; }\n    }\n\n    function clearChildren(node: HTMLElement) {\n        while (node.firstChild) node.removeChild(node.firstChild);\n    }\n\n    function addGroupBlock(groupId: string = '') {\n        const groupWrap = document.createElement('div');\n        groupWrap.className = 'fb-group-block';\n        groupWrap.style.border = '1px solid #e5e7eb';\n        groupWrap.style.borderRadius = '6px';\n        groupWrap.style.padding = '8px';\n        groupWrap.style.marginTop = '8px';\n\n        // Header: Group ID outside inner body\n        const header = document.createElement('div');\n        header.style.display = 'grid';\n        header.style.gridTemplateColumns = '1fr auto';\n        header.style.gap = '8px';\n        header.style.alignItems = 'center';\n\n        const idInput = document.createElement('input');\n        idInput.className = 'form-control form-control-sm fb-group-id';\n        idInput.placeholder = 'Group ID (e.g., vehicleDetails)';\n        idInput.value = groupId;\n\n        const delBtn = document.createElement('button');\n        delBtn.type = 'button';\n        delBtn.className = 'btn btn-sm btn-link text-danger';\n        delBtn.textContent = 'remove group';\n        delBtn.addEventListener('click', () => groupWrap.remove());\n\n        header.appendChild(idInput);\n        header.appendChild(delBtn);\n        groupWrap.appendChild(header);\n\n        // Body: dashed box like VE/Advanced bodies\n        const body = document.createElement('div');\n        body.style.border = '1px dashed #cbd5e1';\n        body.style.padding = '8px';\n        body.style.marginTop = '6px';\n        groupWrap.appendChild(body);\n\n        // Mode + Actions\n        const top = document.createElement('div');\n        top.style.display = 'flex';\n        top.style.flexWrap = 'wrap';\n        top.style.gap = '12px';\n        top.style.alignItems = 'center';\n        top.style.marginBottom = '6px';\n\n        const modeLbl = document.createElement('label');\n        modeLbl.textContent = 'Mode';\n        const modeSel = document.createElement('select');\n        modeSel.className = 'form-select form-select-sm fb-group-mode';\n        ['any', 'all'].forEach(v => {\n            const opt = document.createElement('option');\n            opt.value = v; opt.textContent = v.toUpperCase() + (v === 'any' ? ' (OR)' : ' (AND)');\n            modeSel.appendChild(opt);\n        });\n\n        const actionsWrap = document.createElement('div');\n        actionsWrap.innerHTML = `\n      <label style=\"margin-right:8px;\">Actions</label>\n      <label class=\"form-check form-check-inline\"><input class=\"form-check-input fb-act\" type=\"checkbox\" value=\"show\" checked> <span class=\"form-check-label\">show</span></label>\n      <label class=\"form-check form-check-inline\"><input class=\"form-check-input fb-act\" type=\"checkbox\" value=\"require\"> <span class=\"form-check-label\">require</span></label>\n      <label class=\"form-check form-check-inline\"><input class=\"form-check-input fb-act\" type=\"checkbox\" value=\"enable\"> <span class=\"form-check-label\">enable</span></label>\n      <label class=\"form-check form-check-inline\"><input class=\"form-check-input fb-act\" type=\"checkbox\" value=\"disable\"> <span class=\"form-check-label\">disable</span></label>\n      <label class=\"form-check form-check-inline\"><input class=\"form-check-input fb-act\" type=\"checkbox\" value=\"hide\"> <span class=\"form-check-label\">hide</span></label>\n    `;\n\n        const topLeft = document.createElement('div');\n        topLeft.appendChild(modeLbl);\n        topLeft.appendChild(document.createTextNode(' '));\n        topLeft.appendChild(modeSel);\n\n        top.appendChild(topLeft);\n        top.appendChild(actionsWrap);\n        body.appendChild(top);\n\n        // Rules list\n        const rulesList = document.createElement('div');\n        rulesList.className = 'fb-group-rules';\n        body.appendChild(rulesList);\n\n        const addRuleBtn = document.createElement('button');\n        addRuleBtn.type = 'button';\n        addRuleBtn.className = 'btn btn-sm btn-outline-primary';\n        addRuleBtn.textContent = 'Add rule';\n        addRuleBtn.style.marginTop = '8px';\n        body.appendChild(addRuleBtn);\n\n        function addRuleRow(field?: string, op?: string, value?: string) {\n            const row = document.createElement('div');\n            row.className = 'fb-group-rule';\n            row.style.display = 'grid';\n            row.style.gridTemplateColumns = '1fr 1fr 1fr auto';\n            row.style.gap = '6px';\n            row.style.marginTop = '6px';\n\n            // Field select\n            const fSel = document.createElement('select');\n            fSel.className = 'form-select form-select-sm fb-rule-field';\n            getFields().forEach(f => {\n                const opt = document.createElement('option');\n                opt.value = f.name;\n                opt.textContent = f.label ? `${f.label} (${f.name})` : f.name;\n                fSel.appendChild(opt);\n            });\n            if (field) fSel.value = field;\n\n            // Operator\n            const oSel = document.createElement('select');\n            oSel.className = 'form-select form-select-sm fb-rule-op';\n\n            function setOpsForField(fn: string) {\n                const fm = getFields().find(f => f.name === fn);\n                const isNum = fm?.type === 'number';\n                const isChoice = fm?.type === 'radio-group' || fm?.type === 'select' || !!fm?.values?.length;\n                const ops = isNum\n                    ? ['equals', 'notEquals', 'gt', 'gte', 'lt', 'lte', 'isEmpty', 'notEmpty']\n                    : isChoice\n                        ? ['equals', 'notEquals', 'isEmpty', 'notEmpty']\n                        : ['equals', 'notEquals', 'contains', 'startsWith', 'endsWith', 'isEmpty', 'notEmpty'];\n                oSel.innerHTML = '';\n                ops.forEach(o => {\n                    const opt = document.createElement('option');\n                    opt.value = o; opt.textContent = o;\n                    oSel.appendChild(opt);\n                });\n            }\n\n            setOpsForField(fSel.value);\n            if (op) oSel.value = op;\n\n            // Value control\n            const vWrap = document.createElement('div');\n            vWrap.className = 'fb-rule-value-wrap';\n\n            function renderValueControl(fn: string, current?: string) {\n                vWrap.innerHTML = '';\n                const choices = getValuesFor(fn);\n                if (choices && choices.length) {\n                    const s = document.createElement('select');\n                    s.className = 'form-select form-select-sm fb-rule-value';\n                    choices.forEach(c => {\n                        const option = document.createElement('option');\n                        option.value = c.value;\n                        option.textContent = c.label ?? c.value;\n                        s.appendChild(option);\n                    });\n                    if (current) s.value = current;\n                    vWrap.appendChild(s);\n                } else {\n                    const i = document.createElement('input');\n                    i.type = 'text';\n                    i.className = 'form-control form-control-sm fb-rule-value';\n                    if (current) i.value = current;\n                    vWrap.appendChild(i);\n                }\n            }\n\n            renderValueControl(fSel.value, value);\n\n            // Remove rule\n            const rm = document.createElement('button');\n            rm.type = 'button';\n            rm.className = 'btn btn-sm btn-link text-danger';\n            rm.textContent = 'remove';\n            rm.addEventListener('click', () => row.remove());\n\n            // interactions\n            fSel.addEventListener('change', () => {\n                setOpsForField(fSel.value);\n                renderValueControl(fSel.value);\n            });\n\n            // mount\n            row.appendChild(fSel);\n            row.appendChild(oSel);\n            row.appendChild(vWrap);\n            row.appendChild(rm);\n            rulesList.appendChild(row);\n        }\n\n        addRuleBtn.addEventListener('click', () => addRuleRow());\n\n        // Expose a tiny API to preset values\n        (groupWrap as any)._set = (cfg: { mode?: string; actions?: string[]; rules?: any[] }) => {\n            if (cfg?.mode) (modeSel.value = cfg.mode);\n            const acts = new Set(cfg?.actions || []);\n            (actionsWrap.querySelectorAll('.fb-act') as NodeListOf<HTMLInputElement>).forEach(i => { i.checked = acts.has(i.value); });\n            clearChildren(rulesList);\n            (cfg?.rules || []).forEach((r: any) => addRuleRow(r.field, r.op, r.value));\n        };\n\n        listEl.appendChild(groupWrap);\n        return groupWrap;\n    }\n\n    function renderFromJson(obj: Record<string, any>) {\n        clearChildren(listEl);\n        const keys = Object.keys(obj || {});\n        if (!keys.length) {\n            // Start with one blank group\n            addGroupBlock();\n            return;\n        }\n        keys.forEach(k => {\n            const g = obj[k] || {};\n            const block = addGroupBlock(k);\n            (block as any)._set({ mode: g.mode || 'any', actions: g.actions || [], rules: g.rules || [] });\n        });\n    }\n\n    function collectFromVe(): Record<string, any> {\n        const result: Record<string, any> = {};\n        const blocks = Array.from(listEl.querySelectorAll('.fb-group-block'));\n        blocks.forEach(b => {\n            const id = (b.querySelector('.fb-group-id') as HTMLInputElement).value.trim();\n            if (!id) return; // skip unnamed\n            const mode = (b.querySelector('.fb-group-mode') as HTMLSelectElement).value as 'any' | 'all';\n            const actions = Array.from(b.querySelectorAll('.fb-act') as NodeListOf<HTMLInputElement>)\n                .filter(i => i.checked).map(i => i.value);\n            const rules: any[] = [];\n            b.querySelectorAll('.fb-group-rule').forEach(r => {\n                const field = (r.querySelector('.fb-rule-field') as HTMLSelectElement)?.value;\n                const op = (r.querySelector('.fb-rule-op') as HTMLSelectElement)?.value;\n                const valEl = (r.querySelector('.fb-rule-value') as HTMLInputElement | HTMLSelectElement);\n                const value = (valEl as any)?.value ?? '';\n                if (field && op) rules.push({ field, op, value });\n            });\n            result[id] = { mode, rules, actions };\n        });\n        return result;\n    }\n\n    return {\n        getJson: () => state.json,\n        setJson: (j: string) => { state.json = j; },\n        getGroups: () => safeParse(state.json || '{}') || {},\n    };\n}\n\n","import type { LogicConfig, LogicGroup, Rule, SetupOptions } from '../types';\n\ndeclare global {\n    interface Window {\n        fbLogicGroups?: Record<string, LogicGroup>;\n        __FB_LOGIC_DEBUG__?: boolean;\n        FB_GET_WRAPPER?: (el: HTMLElement) => HTMLElement;\n        _fbLogic?: { refresh: () => void }; // debug handle\n    }\n}\n\n/* ==============================\n   Utilities\n============================== */\n\nfunction cssEscape(name: string) {\n    const CSSObj: any = (window as any).CSS;\n    if (CSSObj && typeof CSSObj.escape === 'function') return CSSObj.escape(name);\n    return name.replace(/([^a-zA-Z0-9_-])/g, '\\\\$1');\n}\n\nfunction sourceSelector(fieldName: string) {\n    const n = cssEscape(fieldName);\n    return `[name=\"${n}\"], [name=\"${n}[]\"], [data-fb-name=\"${n}\"]`;\n}\n\nfunction defaultWrapper(el: HTMLElement): HTMLElement {\n    const candidates = ['.form-group', '.fb-field-wrapper', '.form-field', '.field-wrapper', '.row', '.mb-3', '.box'];\n    for (const c of candidates) {\n        const found = el.closest(c);\n        if (found) return found as HTMLElement;\n    }\n    return el.parentElement || el;\n}\n\nfunction getControlValue(el: HTMLElement): any {\n    if (el instanceof HTMLInputElement) {\n        if (el.type === 'radio') {\n            const name = el.name;\n            const group =\n                el.form?.querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`) ||\n                document.querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`);\n            for (const r of Array.from(group)) {\n                const rr = r as HTMLInputElement;\n                if (rr.checked) return rr.value;\n            }\n            return null;\n        }\n        if (el.type === 'checkbox') {\n            const name = el.name;\n            const group =\n                el.form?.querySelectorAll(`input[type=\"checkbox\"][name=\"${name}\"]`) ||\n                document.querySelectorAll(`input[type=\"checkbox\"][name=\"${name}\"]`);\n            const vals: string[] = [];\n            Array.from(group).forEach((cb) => {\n                const cbb = cb as HTMLInputElement;\n                if (cbb.checked) vals.push(cbb.value);\n            });\n            return vals;\n        }\n        return el.value;\n    }\n    if (el instanceof HTMLSelectElement) {\n        if (el.multiple) return Array.from(el.selectedOptions).map((o) => o.value);\n        return el.value;\n    }\n    if (el instanceof HTMLTextAreaElement) return el.value;\n    return (el as any).value ?? (el as any).textContent ?? null;\n}\n\nfunction testRule(value: any, rule: Rule): boolean {\n    const op = rule.op;\n    const expected = rule.value;\n\n    if (Array.isArray(value)) {\n        if (op === 'contains') return value.includes(expected);\n        if (op === 'equals') return value.includes(expected);\n        if (op === 'notEquals') return !value.includes(expected);\n        if (op === 'isEmpty') return value.length === 0;\n        if (op === 'notEmpty') return value.length > 0;\n        return false;\n    }\n\n    const valStr = value == null ? '' : String(value);\n    const expStr = expected == null ? '' : String(expected);\n    const valNum = Number(value);\n    const expNum = Number(expected);\n\n    switch (op) {\n        case 'equals': return value == expected;\n        case 'notEquals': return value != expected;\n        case 'contains': return valStr.includes(expStr);\n        case 'startsWith': return valStr.startsWith(expStr);\n        case 'endsWith': return valStr.endsWith(expStr);\n        case 'gt': return valNum > expNum;\n        case 'gte': return valNum >= expNum;\n        case 'lt': return valNum < expNum;\n        case 'lte': return valNum <= expNum;\n        case 'isEmpty': return valStr.trim() === '';\n        case 'notEmpty': return valStr.trim() !== '';\n        default: return false;\n    }\n}\n\nfunction evalGroup(form: HTMLElement, group: LogicGroup): boolean {\n    const results = group.rules.map((rule) => {\n        const src = form.querySelector(sourceSelector(rule.field)) as HTMLElement | null;\n        if (!src) return false;\n        const v = getControlValue(src);\n        return testRule(v, rule);\n    });\n    const ok = group.mode === 'all' ? results.every(Boolean) : results.some(Boolean);\n    if (window.__FB_LOGIC_DEBUG__) console.log('[fb-logic] group', group, 'results', results, 'ok?', ok);\n    return ok;\n}\n\nfunction setDisabled(el: HTMLElement, disabled: boolean) {\n    const inputs = el.querySelectorAll('input, select, textarea, button');\n    inputs.forEach((n: Element) => {\n        (n as HTMLInputElement).disabled = disabled;\n        if (disabled) (n as HTMLInputElement).required = false;\n    });\n}\n\nfunction setVisible(el: HTMLElement, visible: boolean) {\n    (el as HTMLElement).style.display = visible ? '' : 'none';\n    (el as HTMLElement).setAttribute('aria-hidden', visible ? 'false' : 'true');\n}\n\n/* ==============================\n   Actions + Targets\n============================== */\n\nfunction applyActions(target: HTMLElement, actions: LogicGroup['actions'], truthy: boolean) {\n    const shouldShow =\n        actions.includes('show') ? truthy :\n            actions.includes('hide') ? !truthy :\n                truthy;\n\n    setVisible(target, shouldShow);\n\n    if (actions.includes('disable')) setDisabled(target, true);\n    if (actions.includes('enable')) setDisabled(target, false);\n\n    if (actions.includes('require')) {\n        const inputs = target.querySelectorAll('input, select, textarea');\n        inputs.forEach((n: Element) => { (n as HTMLInputElement).required = shouldShow; });\n    }\n}\n\nfunction parseLogicAttr(el: HTMLElement): LogicConfig | null {\n    const raw = el.getAttribute('data-logic');\n    if (!raw) return null;\n    try { return JSON.parse(raw) as LogicConfig; }\n    catch {\n        if (window.__FB_LOGIC_DEBUG__) console.warn('Invalid data-logic JSON', raw, el);\n        return null;\n    }\n}\n\n/* ==============================\n   HYDRATION (Builder JSON → DOM)\n============================== */\n\nfunction strifyLogic(logic: any): string | null {\n    if (!logic) return null;\n    if (typeof logic === 'string') return logic;\n    try { return JSON.stringify(logic); } catch { return null; }\n}\n\nfunction queryByNameAll(form: HTMLElement, name: string): NodeListOf<HTMLElement> {\n    const n = cssEscape(name);\n    return form.querySelectorAll<HTMLElement>(`[name=\"${n}\"], [name=\"${n}[]\"]`);\n}\n\nfunction hydrateFromFormData(form: HTMLElement, formData: any) {\n    if (!formData) return;\n    try { if (typeof formData === 'string') formData = JSON.parse(formData); } catch { return; }\n    if (!Array.isArray(formData)) return;\n\n    for (const field of formData) {\n        const name: string | undefined = field?.name;\n        if (!name) continue;\n\n        const nodes = queryByNameAll(form, name);\n        if (!nodes.length) continue;\n\n        const logicJson = strifyLogic(field.logic);\n        const applyTo: string = field.logicApplyTo || field.applyTo || 'self';\n        const groupId: string | undefined = field.logicGroup;\n\n        if (!logicJson && groupId && applyTo === 'group') {\n            nodes.forEach((el) => el.setAttribute('data-logic-group', String(groupId)));\n            continue;\n        }\n\n        if (!logicJson) continue;\n\n        if (applyTo === 'container') {\n            nodes.forEach((el) => {\n                const wrap =\n                    typeof window.FB_GET_WRAPPER === 'function'\n                        ? window.FB_GET_WRAPPER(el)\n                        : defaultWrapper(el);\n                wrap.setAttribute('data-logic-container', logicJson);\n            });\n        } else if (applyTo === 'group' && groupId) {\n            nodes.forEach((el) => el.setAttribute('data-logic-group', String(groupId)));\n        } else {\n            nodes.forEach((el) => el.setAttribute('data-logic', logicJson));\n        }\n    }\n}\n\nfunction normalizeActions(cfg: LogicConfig): LogicGroup['actions'] {\n    const a = (cfg.actions && cfg.actions.length ? cfg.actions : ['show']);\n    return a as LogicGroup['actions'];\n}\n\n/* ==============================\n   Target discovery + evaluation\n============================== */\n\nfunction findTargets(form: HTMLElement): Array<{\n    el: HTMLElement;\n    cfg: LogicConfig;\n    mode: 'self' | 'container' | 'group';\n    groupId?: string;\n}> {\n    const targets: Array<{\n        el: HTMLElement;\n        cfg: LogicConfig;\n        mode: 'self' | 'container' | 'group';\n        groupId?: string;\n    }> = [];\n\n    form.querySelectorAll('[data-logic]').forEach((el) => {\n        const cfg = parseLogicAttr(el as HTMLElement);\n        if (cfg) targets.push({ el: el as HTMLElement, cfg, mode: 'self' });\n    });\n\n    form.querySelectorAll('[data-logic-container]').forEach((el) => {\n        const raw = (el as HTMLElement).getAttribute('data-logic-container');\n        if (!raw) return;\n        try { targets.push({ el: el as HTMLElement, cfg: JSON.parse(raw) as LogicConfig, mode: 'container' }); }\n        catch { }\n    });\n\n    form.querySelectorAll('[data-logic-group]').forEach((el) => {\n        const id = (el as HTMLElement).getAttribute('data-logic-group') || '';\n        const group = window.fbLogicGroups?.[id];\n        if (group) {\n            const cfg: LogicConfig = { groups: [group], actions: group.actions, applyTo: 'group', logicGroup: id };\n            targets.push({ el: el as HTMLElement, cfg, mode: 'group', groupId: id });\n        }\n    });\n\n    if (window.__FB_LOGIC_DEBUG__) {\n        console.log('[fb-logic] targets found:', targets.length, targets);\n    }\n    return targets;\n}\n\nfunction reeval(form: HTMLElement, targets: ReturnType<typeof findTargets>, options: SetupOptions) {\n    const getWrapper = options.getWrapper || defaultWrapper;\n\n    targets.forEach((t) => {\n        const el = t.el;\n\n        let truthy = true;\n        if (t.cfg.groups && t.cfg.groups.length) truthy = t.cfg.groups.every((g) => evalGroup(form, g));\n\n        const wrapper =\n            t.mode === 'self' ? getWrapper(el) :\n                t.mode === 'container' ? el :\n                    getWrapper(el);\n\n        const actions = normalizeActions(t.cfg);\n        applyActions(wrapper, actions, truthy);\n\n        if (options.onState) options.onState(el, truthy);\n        if (window.__FB_LOGIC_DEBUG__) console.log('[fb-logic] applied', { el, mode: t.mode, actions, truthy, wrapper });\n    });\n}\n\n/* ==============================\n   Public API\n============================== */\n\nexport function setup(formEl: HTMLElement | Element, _formData?: any, options: SetupOptions = {}) {\n    const form = formEl as HTMLElement;\n\n    if (_formData) {\n        try { hydrateFromFormData(form, _formData); }\n        catch (e) { if (window.__FB_LOGIC_DEBUG__) console.warn('hydrateFromFormData failed', e); }\n    }\n\n    const targets = findTargets(form);\n\n    const watched = new Set<string>();\n    targets.forEach((t) => { t.cfg.groups?.forEach((g) => g.rules.forEach((r) => watched.add(r.field))); });\n    if (window.__FB_LOGIC_DEBUG__) console.log('[fb-logic] watching fields:', Array.from(watched));\n\n    const handler = (ev: Event) => {\n        const nameAttr = (ev.target as HTMLInputElement)?.name;\n        if (!nameAttr) return;\n        const simple = nameAttr.replace(/\\[\\]$/, '');\n        if (watched.has(nameAttr) || watched.has(simple)) {\n            if (window.__FB_LOGIC_DEBUG__) console.log('[fb-logic] change on', nameAttr, '→ reeval');\n            reeval(form, targets, options);\n        }\n    };\n\n    form.addEventListener('input', handler, true);\n    form.addEventListener('change', handler, true);\n\n    reeval(form, targets, options);\n\n    form.addEventListener('fb:reinit-logic' as any, () => reeval(form, targets, options));\n\n    const api = {\n        refresh: () => reeval(form, targets, options),\n        destroy: () => {\n            form.removeEventListener('input', handler, true);\n            form.removeEventListener('change', handler, true);\n        },\n    };\n    // expose for quick debugging from console\n    (window as any)._fbLogic = api;\n    return api;\n}\n\nexport function refresh(formEl: HTMLElement | Element) {\n    setup(formEl);\n}\n\nexport function evaluateField(formEl: HTMLElement | Element, _name: string) {\n    setup(formEl);\n}\n"],"names":["DEFAULT_TYPES","withConditionalLogic","opts","panelTitle","types","enableVE","typeUserAttrs","t","inferFieldsFromBuilderJson","_a","_b","_c","stage","inst","json","f","v","getFields","custom","getValuesFor","fieldName","fm","makeVE","htmlParent","getTextArea","getApplyTo","getGroupId","ve","hdr","veBody","modeWrap","actionsWrap","rules","addBtn","row","field","op","value","fSel","opt","oSel","setOpsForField","fn","isNum","isChoice","ops","o","vWrap","renderValueControl","current","choices","s","c","option","i","rm","save","_mode","_actions","r","cfg","raw","parsed","g","acts","onOpenFieldEdit","editPanel","logicControls","section","header","body","open","dupes","el","idx","adv","advHeader","advBody","seen","ctrl","n","dupRow","attachLogicGroupsManager","targetContainer","initialOrOpts","state","_d","wrapper","btn","modal","closeBtn","loadBtn","saveBtn","fromJson","advHdr","ta","listEl","srcObj","safeParse","renderFromJson","close","e","sample","obj","collectFromVe","addGroupBlock","txt","clearChildren","node","groupId","groupWrap","idInput","delBtn","top","modeLbl","modeSel","topLeft","rulesList","addRuleBtn","addRuleRow","keys","k","result","b","id","mode","actions","valEl","j","cssEscape","name","CSSObj","sourceSelector","defaultWrapper","candidates","found","getControlValue","group","rr","vals","cb","cbb","testRule","rule","expected","valStr","expStr","valNum","expNum","evalGroup","form","results","src","ok","setDisabled","disabled","setVisible","visible","applyActions","target","truthy","shouldShow","parseLogicAttr","strifyLogic","logic","queryByNameAll","hydrateFromFormData","formData","nodes","logicJson","applyTo","normalizeActions","findTargets","targets","reeval","options","getWrapper","setup","formEl","_formData","watched","handler","ev","nameAttr","simple","api","refresh","evaluateField","_name"],"mappings":"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"}